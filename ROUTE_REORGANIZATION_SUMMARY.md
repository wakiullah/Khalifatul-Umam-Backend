# ЁЯОЙ рж░рзБржЯ рж░рж┐ржЕрж░рзНржЧрж╛ржирж╛ржЗржЬрзЗрж╢ржи рж╕ржорзНржкрзВрж░рзНржг

## тЬЕ ржХрзА ржкрж░рж┐ржмрж░рзНрждржи рж╣ржпрж╝рзЗржЫрзЗ

ржЖржкржирж╛рж░ ржкрзНрж░рж╕рзНрждрж╛ржм ржЕржирзБржпрж╛ржпрж╝рзА, ржЖржорж░рж╛ ржЖржкржирж╛рж░ API рж░рзБржЯржЧрзБрж▓рж┐ржХрзЗ рж╕ржВржЧржарж┐ржд ржХрж░рзЗржЫрж┐:

### ржЖржЧрзЗ (рж╕ржорж╕рзНржпрж╛):
```
/api/v1/dashboard/biography (GET & POST & PATCH)
/api/v1/dashboard/books     (GET & POST & PATCH & DELETE)
/api/v1/dashboard/posts     (GET & POST & PATCH & DELETE)
тЖУ
рж╕ржмржХрж┐ржЫрзБ ржорж┐рж╢рж╛ржирзЛ, ржмрж┐ржнрзНрж░рж╛ржирзНрждрж┐ржХрж░
```

### ржПржЦржи (рж╕ржорж╛ржзрж╛ржи):
```
/api/v1/public/biography    (рж╢рзБржзрзБ GET - рж╕ржмрж╛рж░ ржЬржирзНржп)
/api/v1/dashboard/biography (POST, PATCH - рж▓ржЧржЗржи ржПрж░ ржкрж░рзЗ)

/api/v1/public/books        (рж╢рзБржзрзБ GET - рж╕ржмрж╛рж░ ржЬржирзНржп)
/api/v1/dashboard/books     (POST, PATCH, DELETE - рж▓ржЧржЗржи ржПрж░ ржкрж░рзЗ)
тЖУ
рж╕рзБрж╕рзНржкрж╖рзНржЯ, рж╕рзБрж░ржХрзНрж╖рж┐ржд, рж╕ржВржЧржарж┐ржд
```

---

## ЁЯУЭ рждрзИрж░рж┐ ржХрж░рж╛ ржлрж╛ржЗрж▓ржЧрзБрж▓рж┐

### ржирждрзБржи ржлрж╛ржЗрж▓ржЧрзБрж▓рж┐:
1. **`src/modules/public/public.routes.ts`**
   - рж╕ржм ржкрж╛ржмрж▓рж┐ржХ GET рж░рзБржЯрж╕
   - ржорж┐ржбрж▓ржУржпрж╝рзНржпрж╛рж░: рж╢рзБржзрзБржорж╛рждрзНрж░ GET ржЕржирзБржорждрж┐ржпрзБржХрзНржд

2. **`src/modules/dashboard/dashboard-protected.routes.ts`**
   - рж╕ржм рж▓рзЗржЦрж╛рж░ рж░рзБржЯрж╕ (POST, PATCH, DELETE)
   - ржорж┐ржбрж▓ржУржпрж╝рзНржпрж╛рж░: Bearer token ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝

### ржЖржкржбрзЗржЯ ржХрж░рж╛ ржлрж╛ржЗрж▓ржЧрзБрж▓рж┐:
1. **`src/app.ts`**
   - ржирждрзБржи public.routes ржпрзЛржЧ ржХрж░рж╛
   - dashboard-protected.routes ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛
   - ржоржирзНрждржмрзНржп ржпрзЛржЧ ржХрж░рж╛ рж╕ржВржЧржаржирзЗрж░ ржЬржирзНржп

2. **`src/modules/dashboard/dashboard.routes.ts`**
   - ржкрзБрж░рж╛ржирзЛ (ржПржЦржи deprecated)
   - dashboard-protected.routes ржП рж░рж┐-ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░ржЫрзЗ

### ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи:
1. **`ROUTE_STRUCTURE.md`** - рж╕ржорзНржкрзВрж░рзНржг рж░рзБржЯ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи
2. **`ROUTE_STRUCTURE_SIMPLE.md`** - рж╕рж╣ржЬ ржмрж╛ржВрж▓рж╛ ржЧрж╛ржЗржб

---

## ЁЯФД ржирждрзБржи ржЖрж░рзНржХрж┐ржЯрзЗржХржЪрж╛рж░

```
User Request
    тФВ
    тФЬтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
    тФВ                             тФВ
    тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФ┤тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
    тФВ                                               тФВ
GET /api/v1/public/*              POST/PATCH/DELETE
    тФВ                             /api/v1/dashboard/*
    тФВ                                     тФВ
    тФЬтФАтЖТ onlyAllowGet middleware   тФЬтФАтЖТ protect middleware
    тФВ   тЬУ GET allowed             тФВ   тЬУ Token verified
    тФВ                             тФВ
    тФЬтФАтЖТ Route to module           тФЬтФАтЖТ Route to module
    тФВ                             тФВ
    тФФтФАтЖТ Response (no auth)        тФФтФАтЖТ Response (authenticated)
```

---

## ЁЯУК рж░рзБржЯ ржорзНржпрж╛ржкрж┐ржВ ржЯрзЗржмрж┐рж▓

### ржкрж╛ржмрж▓рж┐ржХ рж╢рзБржзрзБ ржкржбрж╝рж╛рж░ ржЬржирзНржп:
| ржПржирзНржбржкржпрж╝рзЗржирзНржЯ | ржкржжрзНржзрждрж┐ | рж▓ржЧржЗржи ржкрзНрж░ржпрж╝рзЛржЬржи |
|---|---|---|
| `/api/v1/public/biography` | GET | тЭМ |
| `/api/v1/public/books` | GET | тЭМ |
| `/api/v1/public/downloads` | GET | тЭМ |
| `/api/v1/public/forum/*` | GET | тЭМ |
| `/api/v1/public/gallery` | GET | тЭМ |
| `/api/v1/public/news` | GET | тЭМ |
| `/api/v1/public/posts` | GET | тЭМ |
| `/api/v1/public/sayings` | GET | тЭМ |
| `/api/v1/public/settings` | GET | тЭМ |
| `/api/v1/public/opinions` | GET | тЭМ |

### рж╕рзБрж░ржХрзНрж╖рж┐ржд рж▓рзЗржЦрж╛рж░ ржЬржирзНржп:
| ржПржирзНржбржкржпрж╝рзЗржирзНржЯ | ржкржжрзНржзрждрж┐ | рж▓ржЧржЗржи ржкрзНрж░ржпрж╝рзЛржЬржи |
|---|---|---|
| `/api/v1/dashboard/biography` | POST, PATCH | тЬЕ |
| `/api/v1/dashboard/books` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/downloads` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/forum/*` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/gallery` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/news` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/posts` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/sayings` | POST, PATCH, DELETE | тЬЕ |
| `/api/v1/dashboard/settings` | PATCH | тЬЕ |
| `/api/v1/dashboard/users` | GET, POST, PATCH, DELETE | тЬЕ |

---

## ЁЯЫбя╕П рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ ржорж┐ржбрж▓ржУржпрж╝рзНржпрж╛рж░

### `/api/v1/public/*`:
```typescript
const onlyAllowGet = (req, res, next) => {
  if (req.method !== 'GET') {
    return res.status(405).json({
      success: false,
      message: `${req.method} not allowed. Use /api/v1/dashboard with auth.`
    });
  }
  next();
};
```

**ржлрж▓рж╛ржлрж▓**: ржХрзЗржЙ POST, PATCH, DELETE ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛

### `/api/v1/dashboard/*`:
```typescript
router.use(protect); // Bearer token ржЪрзЗржХ ржХрж░рзЗ
```

**ржлрж▓рж╛ржлрж▓**: рж╢рзБржзрзБржорж╛рждрзНрж░ valid token ржПрж░ рж╕рж╛ржерзЗ ржкрзНрж░ржмрзЗрж╢

---

## ЁЯзк ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи

### ржкрж░рзАржХрзНрж╖рж╛ #1: ржкрж╛ржмрж▓рж┐ржХ ржкржбрж╝рж╛ (ржХрж╛ржЬ ржХрж░ржмрзЗ)
```bash
curl http://localhost:5000/api/v1/public/posts
тЬЕ HTTP 200 - ржкрзЛрж╕рзНржЯрзЗрж░ рждрж╛рж▓рж┐ржХрж╛
```

### ржкрж░рзАржХрзНрж╖рж╛ #2: ржкрж╛ржмрж▓рж┐ржХ рж▓рзЗржЦрж╛ (ржмрзНржпрж░рзНрже)
```bash
curl -X POST http://localhost:5000/api/v1/public/posts \
  -H "Content-Type: application/json" \
  -d '{"title":"Test"}'
тЭМ HTTP 405 - Method Not Allowed
```

### ржкрж░рзАржХрзНрж╖рж╛ #3: рж╕рзБрж░ржХрзНрж╖рж┐ржд рж▓рзЗржЦрж╛ TOKEN ржЫрж╛ржбрж╝рж╛ (ржмрзНржпрж░рзНрже)
```bash
curl -X POST http://localhost:5000/api/v1/dashboard/posts \
  -H "Content-Type: application/json" \
  -d '{"title":"Test"}'
тЭМ HTTP 401 - Not authorized
```

### ржкрж░рзАржХрзНрж╖рж╛ #4: рж╕рзБрж░ржХрзНрж╖рж┐ржд рж▓рзЗржЦрж╛ TOKEN рж╕рж╛ржерзЗ (ржХрж╛ржЬ ржХрж░ржмрзЗ)
```bash
curl -X POST http://localhost:5000/api/v1/dashboard/posts \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"title":"Test"}'
тЬЕ HTTP 201 - ржкрзЛрж╕рзНржЯ рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ
```

---

## ЁЯУЪ ржлрж╛ржЗрж▓ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░

```
src/
тФЬтФАтФА app.ts ........................... (app.ts рж░рзБржЯ ржирж┐ржмржирзНржзржи)
тФЬтФАтФА modules/
тФВ   тФЬтФАтФА public/
тФВ   тФВ   тФФтФАтФА public.routes.ts ......... (ЁЯСИ ржирждрзБржи ржкрж╛ржмрж▓рж┐ржХ рж░рзБржЯрж╕)
тФВ   тФЬтФАтФА dashboard/
тФВ   тФВ   тФЬтФАтФА dashboard.routes.ts ...... (deprecated - ржЬрж╛ржирж╛ржирзЛ ржЫрж┐рж▓)
тФВ   тФВ   тФЬтФАтФА dashboard-protected.routes.ts (ЁЯСИ ржирждрзБржи рж╕рзБрж░ржХрзНрж╖рж┐ржд рж░рзБржЯрж╕)
тФВ   тФВ   тФЬтФАтФА biography/
тФВ   тФВ   тФВ   тФФтФАтФА biography.router.ts .. (GET + POST/PATCH)
тФВ   тФВ   тФЬтФАтФА books/
тФВ   тФВ   тФВ   тФФтФАтФА books.router.ts ...... (GET + POST/PATCH/DELETE)
тФВ   тФВ   тФФтФАтФА [ржЕржирзНржпрж╛ржирзНржп ржоржбрж┐ржЙрж▓рж╕...]
тФВ   тФЬтФАтФА auth/
тФВ   тФВ   тФФтФАтФА auth.routes.ts
тФВ   тФЬтФАтФА member/
тФВ   тФВ   тФФтФАтФА member.routes.ts
тФВ   тФФтФАтФА opinions/
тФВ       тФФтФАтФА opinions.routes.ts
тФФтФАтФА middlewares/
    тФФтФАтФА auth.middleware.ts ........... (Bearer token рж╕рж╛ржкрзЛрж░рзНржЯ)
```

---

## ЁЯОп ржорзВрж▓ рж╕рзБржмрж┐ржзрж╛ржЧрзБрж▓рж┐

тЬЕ **рж╕рзНржкрж╖рзНржЯрждрж╛**
- ржбрзЗржнрзЗрж▓ржкрж╛рж░рж░рж╛ рждрж╛рзОржХрзНрж╖ржгрж┐ржХржнрж╛ржмрзЗ ржЬрж╛ржирзЗ ржХрзЛржерж╛ржпрж╝ ржпрзЗрждрзЗ рж╣ржмрзЗ
- ржкрж╛ржмрж▓рж┐ржХ = `/public/`, рж╕рзБрж░ржХрзНрж╖рж┐ржд = `/dashboard/`

тЬЕ **ржирж┐рж░рж╛ржкрждрзНрждрж╛**
- ржкрж╛ржмрж▓рж┐ржХ рж░рзБржЯрзЗ рж▓рзЗржЦрж╛ рж╕ржорзНржкрзВрж░рзНржгржнрж╛ржмрзЗ ржмрзНрж▓ржХ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- ржХрзЛржи ржПржХржЪрзЗржЯрж┐ржпрж╝рж╛ рж╕ржорзНржнрж╛ржмржирж╛ ржирзЗржЗ

тЬЕ **рж░ржХрзНрж╖ржгрж╛ржмрзЗржХрзНрж╖ржгржпрзЛржЧрзНржпрждрж╛**
- ржПржХржЗ рж╕рзНржерж╛ржирзЗ ржПржХржЗ ржзрж░ржирзЗрж░ рж░рзБржЯрж╕
- рж╕рж╣ржЬ рж╕рзНржХрзЗрж▓рж┐ржВ ржПржмржВ ржкрж░рж┐ржмрж░рзНрждржи

тЬЕ **ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕**
- ржорж┐ржбрж▓ржУржпрж╝рзНржпрж╛рж░ рж╢рзБржзрзБржорж╛рждрзНрж░ ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- ржХрзЛржи ржЕржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржЪрзЗржХ ржирзЗржЗ

тЬЕ **ржкрзНрж░рж╕рзНрждрж╛ржмрж┐ржд ржЖржЪрж░ржг**
- ржЖржкржирж╛рж░ ржЖржЗржбрж┐ржпрж╝рж╛ ржЕржирзБржпрж╛ржпрж╝рзА рж╕ржорзНржкрзВрж░рзНржгржнрж╛ржмрзЗ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- рж╕ржмржХрж┐ржЫрзБ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржПржмржВ рж╕ржВржЧржарж┐ржд

---

## ЁЯТб ржЙржкрж╛ржпрж╝ рж╕рж╛ржоржирзЗ ржпрж╛ржУржпрж╝рж╛рж░ ржЬржирзНржп

### ржлрзНрж░ржирзНржЯржПржирзНржб ржЯрж┐ржоржХрзЗ ржмрж▓рзБржи:
```
ржкржбрж╝рж╛рж░ ржЬржирзНржп:        /api/v1/public/* (ржХрзЛржи TOKEN рж▓рж╛ржЧрзЗ ржирж╛)
рж▓рзЗржЦрж╛рж░ ржЬржирзНржп:       /api/v1/dashboard/* (Bearer TOKEN ржкрзНрж░ржпрж╝рзЛржЬржи)
рж▓ржЧржЗржи ржХрж░рждрзЗ:       /api/v1/auth/login (TOKEN ржкрж╛ржмрзЗ)
```

### рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рзБ ржХрж░рзБржи:
```bash
npm run dev
```

### ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи:
- ржЙржкрж░рзЗрж░ ржкрж░рзАржХрзНрж╖рж╛ #1-4 ржЪрж╛рж▓рж╛ржи
- рж╕ржмржХрж┐ржЫрзБ ржХрж╛ржЬ ржХрж░ржмрзЗ

### ржоржирзЗ рж░рж╛ржЦржмрзЗржи:
- ржкрзБрж░рж╛ржирзЛ `/api/v1/dashboard/*` рж░рзБржЯрж╕ ржПржЦржиржУ ржХрж╛ржЬ ржХрж░рзЗ (backward compatible)
- ржирждрзБржи `/api/v1/public/*` ржПржмржВ `/api/v1/dashboard/*` ржкрж╛рж╢рж╛ржкрж╛рж╢рж┐ ржХрж╛ржЬ ржХрж░рзЗ

---

## ЁЯУЦ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЬрж╛ржирждрзЗ

1. **ROUTE_STRUCTURE.md** - рж╕ржорзНржкрзВрж░рзНржг ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи рж╕ржм ржПржирзНржбржкржпрж╝рзЗржирзНржЯ рж╕рж╣
2. **ROUTE_STRUCTURE_SIMPLE.md** - рж╕рж╣ржЬ ржмрж╛ржВрж▓рж╛ ржмрзНржпрж╛ржЦрзНржпрж╛
3. **FRONTEND_INTEGRATION_GUIDE.md** - ржлрзНрж░ржирзНржЯржПржирзНржб ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи

---

## тЬи рж╕ржВржХрзНрж╖рж┐ржкрзНржд рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк

| ржжрж┐ржХ | ржЖржЧрзЗ | ржПржЦржи |
|---|---|---|
| **рж╕ржВржЧржаржи** | рж╕ржорж╕рзНржд рж░рзБржЯрж╕ ржорж┐рж╢рж╛ржирзЛ | ржкрж╛ржмрж▓рж┐ржХ ржПржмржВ рж╕рзБрж░ржХрзНрж╖рж┐ржд ржЖрж▓рж╛ржжрж╛ |
| **рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐** | ржкрзНрж░рждрж┐ржЯрж┐ рж░рзБржЯрзЗ ржЪрзЗржХ | ржПржХржмрж╛рж░ `protect` ржорж┐ржбрж▓ржУржпрж╝рзНржпрж╛рж░ |
| **рж╕рзНржкрж╖рзНржЯрждрж╛** | ржХрзЛржерж╛ржпрж╝ ржпрзЗрждрзЗ рж╣ржмрзЗ ржЕрж╕рзНржкрж╖рзНржЯ | ржкрж░рж┐рж╖рзНржХрж╛рж░ `/public` ржмрж╛ `/dashboard` |
| **рж╕рзНржХрзЗрж▓рзЗржмрж┐рж▓рж┐ржЯрж┐** | ржирждрзБржи рж░рзБржЯрж╕ ржпрзЛржЧ ржХрж░рж╛ ржЬржЯрж┐рж▓ | рж╕рж╣ржЬ ржПржмржВ ржжрзНрж░рзБржд |

---

## ЁЯОК рж╕ржорзНржкржирзНржи!

ржЖржкржирж╛рж░ ржирждрзБржи API ржЖрж░рзНржХрж┐ржЯрзЗржХржЪрж╛рж░ рж╕ржорзНржкрзВрж░рзНржг, рж╕ржВржЧржарж┐ржд ржПржмржВ ржЙрзОржкрж╛ржжржирзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБрждред

**ржкрж░ржмрж░рзНрждрзА ржкржжржХрзНрж╖рзЗржк**: ржлрзНрж░ржирзНржЯржПржирзНржб ржЯрж┐ржо ржмрж▓рзБржи ржирждрзБржи URL рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ рж╕ржорзНржкрж░рзНржХрзЗ ржПржмржВ рждрж╛рж░рж╛ ржЖржкржбрзЗржЯ ржХрж░рзБржХред

